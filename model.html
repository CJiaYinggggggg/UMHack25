<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Models Documentation</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <h1>Models</h1>
    <p>An overview of the machine learning models used in our trading framework</p>
  </header>

  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="installation.html">Installation</a></li>
      <li><a href="usage.html">Usage Guide</a></li>
      <li><a href="api.html">API Reference</a></li>
      <li><a href="examples.html">Examples</a></li>
      <li><a href="models.html" class="active">Models</a></li>
    </ul>
  </nav>

  <main>
    <!-- Hidden Markov Model Section -->
    <section class="container">
      <h2>Hidden Markov Model (HMM)</h2>
      <p>An HMM uses latent (hidden) states to model market regimes. It consists of:</p>
      <ul>
        <li><strong>States:</strong> e.g., Bull, Bear.</li>
        <li><strong>Transition Matrix:</strong> Probabilities of switching between states.</li>
        <li><strong>Emission Probabilities:</strong> Likelihood of observations given a state.</li>
      </ul>
      
      <h3>Data Collection and Preparation</h3>
      <ul>
        <li><strong>On-chain cryptocurrency data:</strong> blockchain metrics like transactions, volume, etc.</li>
        <li><strong>Macroeconomic indicators:</strong> DFF (Federal Funds Effective Rate), CPIAUCSL (CPI for All Urban Consumers), GDPC1 (Real GDP), UNRATE (Unemployment Rate), DTWEXB (U.S. Dollar Index), M2SL (Monetary Policy).</li>
      </ul>
      
      <h3>Feature Engineering</h3>
      <ul>
        <li><strong>Returns & Log Returns:</strong> Measure price changes between periods.</li>
        <li><strong>Volatility:</strong> Price fluctuation/dispersion.</li>
        <li><strong>Moving Averages (MA10):</strong> 10-period SMAs.</li>
        <li><strong>ROC (5, 10, 20):</strong> Price momentum over respective windows.</li>
        <li><strong>Volume Change:</strong> Trading volume fluctuations.</li>
        <li><strong>Fractional Relationships:</strong> Frac_Open_Close, Frac_Open_High, Frac_Open_Low, Frac_High_Low.</li>
        <li><strong>ATR_14 & RSI_14:</strong> Volatility and momentum indicators.</li>
      </ul>
      
      <h3>Feature Selection</h3>
      <ul>
        <li>Frac_High_Low (volatility)</li>
        <li>ATR_14 (volatility)</li>
        <li>Returns (price changes)</li>
        <li>macro_index_kernel (macroeconomic composite)</li>
      </ul>
      
      <h3>Model Training</h3>
      <ul>
        <li>Train/test/validation split</li>
        <li>Grid Search for hyperparameter tuning</li>
      </ul>
      
      <h3>Regime Identification & Segmentation</h3>
      <ul>
        <li>Detect market states (bull, bear, sideways)</li>
        <li>Segment data by regime for analysis and backtesting</li>
      </ul>
    </section>

    <!-- XGBoost Section -->
    <section class="container">
      <h2>XGBoost</h2>
      <p>Gradient boosting framework using decision trees, with:</p>
      <ul>
        <li><strong>Boosting:</strong> Sequentially add weak learners.</li>
        <li><strong>Regularization:</strong> L1 & L2 penalties.</li>
        <li><strong>Parallelization:</strong> Efficient on large datasets.</li>
      </ul>

      <h3>Workflow Steps</h3>
      <ol>
        <li>Load regime-specific CSVs (regimes_0.csv, regimes_1.csv, ...).</li>
        <li>Drop non-important columns (per HMM).</li>
        <li>Create rolling windows (<code>create_window_sequences</code>).</li>
        <li>Scale features (<code>prepare_data</code>).</li>
        <li>Train-test split.</li>
        <li>Model training.</li>
        <li>Time-series CV & RandomizedSearchCV (<code>optimize_model</code>).</li>
      </ol>

      <pre><code>def create_window_sequences(self, df, top_features):
  # ...
</code></pre>
    </section>

    <!-- LSTM Section -->
    <section class="container">
      <h2>Long Short-Term Memory (LSTM)</h2>
      <p>LSTM networks excel at learning long-term dependencies in sequential data:</p>
      <ul>
        <li><strong>Memory Cells:</strong> Preserve information across time.</li>
        <li><strong>Gates:</strong> Control input, forget, and output flows.</li>
        <li><strong>Training:</strong> BPTT with gradient clipping.</li>
      </ul>
      <p>Applied to predict future price movements from historical windows.</p>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 QuantDoc. All rights reserved.</p>
  </footer>
</body>
</html>
